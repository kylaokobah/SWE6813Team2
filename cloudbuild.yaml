steps:
  #Build the image
  - name: 'gcr.io/cloud-builders/docker'
    args: ['build', '-t', 'gcr.io/gamers-meet-293c1/myapp:v1', '.']
    timeout: 180s

  #Push the image
  - name: 'gcr.io/cloud-builders/docker'
    args: ['push', 'gcr.io/gamers-meet-293c1/myapp:v1']

  # Set a global configuration and check that it's persisted.
  # This configuration won't be included in the resulting builder image.
  - name: 'gcr.io/gamers-meet-293c1/git'
    args: ['config', '--global', 'test.foo', 'bar']
  - name: 'gcr.io/gamers-meet-293c1/git'
    entrypoint: 'bash'
    args: ['-c', 'git config --global --get test.foo | grep ^bar$']

